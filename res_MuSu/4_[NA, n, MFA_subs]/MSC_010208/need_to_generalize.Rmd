We can also show the factor scores for network edges as square matrix of each subject.

```{r squaremat_fi, echo=F, fig.show = 'hide'}
fj1_sqmat <- list()
fj2_sqmat <- list()
for(i in 1:length(subj.name)){
   fj1_sqmat[[i]] <- vec2sqmat(svd.res$ExPosition.Data$fj[gtlabel$subjects_label==subj.name[i],1]) 
   fj2_sqmat[[i]] <- vec2sqmat(svd.res$ExPosition.Data$fj[gtlabel$subjects_label==subj.name[i],2])   
}

heat_fj1 <- list()
heat_fj2 <- list()
for(i in 1:length(subj.name)){
  heat_fj1[i] <- superheat(as.matrix(fj1_sqmat[[i]]), y.axis.reverse = T,
                    membership.rows = parcel.list[[i]]$vox.des$Comm.rcd,
                    membership.cols = parcel.list[[i]]$vox.des$Comm.rcd,                    
                    left.label.col = labelcol[[i]],
                    bottom.label.col = labelcol[[i]],
                    left.label.size = 0.08,
                    bottom.label.size = 0.05,
                    extreme.values.na = FALSE,
                    heat.lim = c(-.005, .005),
                    heat.pal = kovesi.diverging_bwr_40_95_c42(200),
                    heat.pal.values = c(0,0.35,0.5,0.65,1),
                    left.label.text.size = 3,
                    bottom.label.text.size = 2,
                    left.label.text.col = textcol[[i]], 
                    bottom.label.text.col = textcol[[i]], 
                    title=sprintf("%s, dim1",subj.name[i]))
  
  heat_fj2[i] <- superheat(fj2_sqmat[[i]], y.axis.reverse = T,
                    membership.rows = parcel.list[[i]]$vox.des$Comm.rcd,
                    membership.cols = parcel.list[[i]]$vox.des$Comm.rcd,                    
                    left.label.col = labelcol[[i]],
                    bottom.label.col = labelcol[[i]],
                    left.label.size = 0.08,
                    bottom.label.size = 0.05,
                    extreme.values.na = FALSE,
                    heat.lim = c(-.005, .005),
                    heat.pal = kovesi.diverging_bwr_40_95_c42(200),
                    heat.pal.values = c(0,0.35,0.5,0.65,1),
                    left.label.text.size = 3,
                    bottom.label.text.size = 2,
                    left.label.text.col = textcol[[i]], 
                    bottom.label.text.col = textcol[[i]], 
                    title=sprintf("%s, dim2",subj.name[i]))

  
}

```

Node x Node Matrix of Factor Score: Dim 1 & Dim 2
```{r grid_heat_fi, echo=F, fig.height=15, fig.width=(7*length(subj.name))}
print("Dimension 1")
do.call(grid.arrange, c(heat_fj1, ncol=length(subj.name)))

print("Dimension 2")
do.call(grid.arrange, c(heat_fj2, ncol=length(subj.name)))
```

Factor score (Dim 1) in square matrix that have significant contribution only
```{r, squaremat_sigfj1, echo=F, fig.show = 'hide'}
fj_sig <- svd.res$ExPosition.Data$fj
fj_sig[!importantEdg1] <- 0
fj1_sig_sqmat <- list()
for(i in 1:length(subj.name)){
   fj1_sig_sqmat[[i]] <- vec2sqmat(fj_sig[gtlabel$subjects_label==subj.name[i],1])
}

heat_sigfj1 <- list()
for(i in 1:length(subj.name)){
  heat_sigfj1[i] <- superheat(fj1_sig_sqmat[[i]], y.axis.reverse = T,
                                membership.rows = parcel.list[[i]]$vox.des$Comm.rcd,
                                membership.cols = parcel.list[[i]]$vox.des$Comm.rcd,                    
                                left.label.col = labelcol[[i]],
                                bottom.label.col = labelcol[[i]],
                                left.label.size = 0.08,
                                bottom.label.size = 0.05,
                                extreme.values.na = FALSE,
                                heat.lim = c(-.005, .005),
                                heat.pal = kovesi.diverging_bwr_40_95_c42(200),
                                heat.pal.values = c(0,0.35,0.5,0.65,1),
                                left.label.text.size = 3,
                                bottom.label.text.size = 2,
                                left.label.text.col = textcol[[i]], 
                                bottom.label.text.col = textcol[[i]], 
                                title=sprintf("%s: significant contribution",subj.name[i]))
}
```

Node x Node Matrix of Factor Score w/ Sig Contribution: Dim 1
```{r, grid_heat_sigfj1, echo=F, fig.height=8, fig.width=(7*length(subj.name))}
do.call(grid.arrange, c(heat_sigfj1, ncol=length(subj.name)))
```

Smoothed Sig Factor Score (Dim 1)
```{r, sm_squaremat_sigfj1, echo=F, fig.show = 'hide'}
#--- the important variables are the ones that contribute more than or equal to the average
sm_heat_sigfj1 <- list()
for(i in 1:length(subj.name)){
sm_heat_sigfj1[i] <- superheat(fj1_sig_sqmat[[i]], y.axis.reverse = T,
                              smooth.heat = T, smooth.heat.type = "mean",
                              membership.rows = parcel.list[[i]]$vox.des$Comm.rcd,
                              membership.cols = parcel.list[[i]]$vox.des$Comm.rcd,                    
                              left.label.col = labelcol[[i]],
                              bottom.label.col = labelcol[[i]],
                              left.label.size = 0.08,
                              bottom.label.size = 0.05,
                              extreme.values.na = FALSE,
                              heat.lim = c(-.005, .005),
                              heat.pal = kovesi.diverging_bwr_40_95_c42(200),
                              heat.pal.values = c(0,0.35,0.5,0.65,1),
                              left.label.text.size = 3,
                              bottom.label.text.size = 2,
                              left.label.text.col = textcol[[i]], 
                              bottom.label.text.col = textcol[[i]], 
                              title=sprintf("%s: significant contribution (mean-smooth)",subj.name[i]))
}

```

Smoothed Node x Node Matrix of Factor Score w/ Sig Contribution: Dim 1
```{r, grid_smheat_sigfj1, echo=F, fig.height=8, fig.width=(7*length(subj.name))}
do.call(grid.arrange, c(sm_heat_sigfj1, ncol=length(subj.name)))
```

Factor score (Dim 2) in square matrix that have significant contribution only
```{r, squaremat_sigfj2, echo=F, fig.show = 'hide'}
fj2_sig_sqmat <- list()
for(i in 1:length(subj.name)){
   fj2_sig_sqmat[[i]] <- vec2sqmat(fj_sig[gtlabel$subjects_label==subj.name[i],2])
}

heat_sigfj2 <- list()
for(i in 1:length(subj.name)){
  heat_sigfj2[i] <- superheat(fj2_sig_sqmat[[i]], y.axis.reverse = T,
                                membership.rows = parcel.list[[i]]$vox.des$Comm.rcd,
                                membership.cols = parcel.list[[i]]$vox.des$Comm.rcd,                    
                                left.label.col = labelcol[[i]],
                                bottom.label.col = labelcol[[i]],
                                left.label.size = 0.08,
                                bottom.label.size = 0.05,
                                extreme.values.na = FALSE,
                                heat.lim = c(-.005, .005),
                                heat.pal = kovesi.diverging_bwr_40_95_c42(200),
                                heat.pal.values = c(0,0.35,0.5,0.65,1),
                                left.label.text.size = 3,
                                bottom.label.text.size = 2,
                                left.label.text.col = textcol[[i]], 
                                bottom.label.text.col = textcol[[i]], 
                                title=sprintf("%s: significant contribution",subj.name[i]))
}

```

Node x Node Matrix of Factor Score w/ Sig Contribution: Dim 2
```{r, grid_heat_sigfj2, echo=F, fig.height=8, fig.width=(7*length(subj.name))}
do.call(grid.arrange, c(heat_sigfj2, ncol=length(subj.name)))
```

Smoothed Sig Factor Score (Dim 2)
```{r, sm_squaremat_sigfj2, echo=F, fig.show = 'hide'}
#--- the important variables are the ones that contribute more than or equal to the average
sm_heat_sigfj2 <- list()
for(i in 1:length(subj.name)){
sm_heat_sigfj2[i] <- superheat(fj2_sig_sqmat[[i]], y.axis.reverse = T,
                              smooth.heat = T, smooth.heat.type = "mean",
                              membership.rows = parcel.list[[i]]$vox.des$Comm.rcd,
                              membership.cols = parcel.list[[i]]$vox.des$Comm.rcd,                    
                              left.label.col = labelcol[[i]],
                              bottom.label.col = labelcol[[i]],
                              left.label.size = 0.08,
                              bottom.label.size = 0.05,
                              extreme.values.na = FALSE,
                              heat.lim = c(-.005, .005),
                              heat.pal = kovesi.diverging_bwr_40_95_c42(200),
                              heat.pal.values = c(0,0.35,0.5,0.65,1),
                              left.label.text.size = 3,
                              bottom.label.text.size = 2,
                              left.label.text.col = textcol[[i]], 
                              bottom.label.text.col = textcol[[i]], 
                              title=sprintf("%s: significant contribution (mean-smooth)",subj.name[i]))
}
```

Smoothed Node x Node Matrix of Factor Score w/ Sig Contribution: Dim 2
```{r, grid_smheat_sigfj2, echo=F, fig.height=8, fig.width=(7*length(subj.name))}
do.call(grid.arrange, c(sm_heat_sigfj2, ncol=length(subj.name)))
```

